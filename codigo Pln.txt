import nltk
from nltk.stem.snowball import SnowballStemmer
import spacy
from gensim.models import Word2Vec
from transformers import pipeline

# Baixar apenas o punkt padr√£o (n√£o precisa do punkt_tab)
nltk.download("punkt")

# Carregar modelo de portugu√™s do spaCy
nlp = spacy.load("pt_core_news_sm")

# Inicializar stemmer para portugu√™s
stemmer = SnowballStemmer("portuguese")

# Lista de feedbacks
feedbacks = [
    'Produto chegou antes do prazo, muito bem embalado',
    'Qualidade surpreendente pelo pre√ßo, super recomendo',
    'Atendimento r√°pido e atencioso, tiraram todas minhas d√∫vidas',
    'Design moderno e bonito, combina com qualquer ambiente',
    'Funciona exatamente como descrito, sem surpresas negativas',
    'Material resistente, parece que vai durar bastante',
    'F√°cil de usar, at√© para quem n√£o entende muito de tecnologia',
    '√ìtimo custo-benef√≠cio, vale cada centavo',
    'Manual bem explicado, instala√ß√£o simples',
    'Produto leve e pr√°tico de transportar',
    'A bateria dura muito mais do que eu esperava',
    'Excelente para presentear, embalagem elegante',
    'Atendimento p√≥s-venda impec√°vel, resolveram meu problema r√°pido',
    'Superou minhas expectativas, desempenho acima da m√©dia',
    'Recomendo para amigos e familiares, todos ficaram satisfeitos',
    'Produto veio com arranh√µes, parecia usado',
    'Manual confuso, demorei para entender como montar',
    'Atendimento demorado, fiquei dias sem resposta',
    'N√£o correspondeu √†s fotos do an√∫ncio',
    'Material fr√°gil, quebrou em pouco tempo',
    'O pre√ßo √© alto para a qualidade entregue',
    'Embalagem mal feita, chegou amassado',
    'Produto esquenta demais durante o uso',
    'N√£o funcionou como prometido, fiquei decepcionado',
    'O som √© baixo, n√£o atende ambientes maiores',
    'A bateria descarrega r√°pido, n√£o dura um dia inteiro',
    'Achei pesado e desconfort√°vel para carregar',
    'O cheiro do material √© forte e desagrad√°vel',
    'N√£o tem suporte t√©cnico na minha regi√£o',
    'O prazo de entrega foi muito maior do que o informado'
]

# Pr√©-processamento: tokeniza√ß√£o com spaCy
sentences = []
for fb in feedbacks:
    doc = nlp(fb)
    tokens_spacy = [token.text.lower() for token in doc if not token.is_punct]  # remover pontua√ß√£o
    lemmas_spacy = [token.lemma_.lower() for token in doc if not token.is_punct]
    stems_nltk = [stemmer.stem(token) for token in tokens_spacy]

    # Guardar frases tokenizadas para Word2Vec
    sentences.append(tokens_spacy)

    # Exibir resultados
    print(f"üìå Feedback: {fb}")
    print(f"üîπ Tokens (spaCy): {tokens_spacy}")
    print(f"üîπ Lemas (spaCy): {lemmas_spacy}")
    print(f"üîπ Stems (NLTK): {stems_nltk}")
    print("-" * 80)

# Treinar modelo Word2Vec com os feedbacks
model = Word2Vec(sentences, vector_size=100, window=5, min_count=1, sg=1)

# Exemplos de uso do Word2Vec
print("\n=== Exemplos Word2Vec ===")
print("Similaridade entre 'produto' e 'qualidade':", model.wv.similarity("produto", "qualidade"))
print("Palavras mais pr√≥ximas de 'atendimento':", model.wv.most_similar("atendimento"))

# ============================
# Etapa 3 ‚Äì An√°lise de Sentimentos com BERT
# ============================

# Carregar pipeline de an√°lise de sentimentos com BERTimbau
classifier = pipeline("sentiment-analysis", model="neuralmind/bert-base-portuguese-cased")

print("\n=== An√°lise de Sentimentos com BERT ===")
for fb in feedbacks:
    result = classifier(fb)[0]
    print(f"üìå Feedback: {fb}")
    print(f"üîπ Sentimento: {result['label']} (confian√ßa: {result['score']:.2f})")
    print("-" * 80)

